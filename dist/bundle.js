(()=>{"use strict";function e(e,t,n){return{configurable:!0,get(){return n.value.bind(this)}}}var t;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(t||(t={}));class n{constructor(e,t,n,r){this.title=e,this.description=t,this.people=n,this.status=r,this.id=Math.random().toString()}}class r extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(...arguments),this.projects=[]}static getInstance(){return this.instance||(this.instance=new r),this.instance}addProject(e,r,s){const i=new n(e,r,s,t.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const s=r.getInstance();function i(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.trim().length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.trim().length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}class l{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}class o extends l{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}cleanInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,n=this.peopleInputElement.value,r={value:t,required:!0,minLength:5},s={value:+n,required:!0,min:1,max:10};if(i({value:e,required:!0})&&i(r)&&i(s))return[e,t,+n];alert("Invalid input, please try again!")}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;s.addProject(e,n,r),this.cleanInputs()}}renderContent(){}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([e],o.prototype,"submitHandler",null);class a extends l{constructor(e,t){super("single-project",e,!0,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){var t;null===(t=e.dataTransfer)||void 0===t||t.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([e],a.prototype,"dragStartHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends l{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const n=e.dataTransfer.getData("text/plain");s.moveProject(n,"active"===this.type?t.Active:t.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),s.addListener((e=>{const n=e.filter((e=>"active"===this.type?e.status===t.Active:e.status===t.Finished));this.assignedProjects=n,this.renderProjects()}))}renderContent(){const e=`${this.type}-project-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-project-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}}c([e],d.prototype,"dragOverHandler",null),c([e],d.prototype,"dropHandler",null),c([e],d.prototype,"dragLeaveHandler",null),new o,new d("active"),new d("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBY3FCLE9BQVNyQixFQUFjc0csU0FDaEcsQ0FHQUMsaUJBQWlCYixHQUNBM0YsS0FBS3NELFFBQVFRLGNBQWMsTUFDbkNvQyxVQUFVTyxPQUFPLFlBQzFCLENBRUF4QyxZQUNFakUsS0FBS3NELFFBQVFZLGlCQUFpQixXQUFZbEUsS0FBS2dHLGlCQUMvQ2hHLEtBQUtzRCxRQUFRWSxpQkFBaUIsWUFBYWxFLEtBQUt3RyxrQkFDaER4RyxLQUFLc0QsUUFBUVksaUJBQWlCLE9BQVFsRSxLQUFLb0csYUFDM0NyRSxFQUFhakIsYUFBYUcsSUFDeEIsTUFBTXlGLEVBQW1CekYsRUFBUzBGLFFBQU9oRixHQUNyQixXQUFkM0IsS0FBSzhGLEtBQ0FuRSxFQUFRcEIsU0FBV04sRUFBY3FCLE9BRW5DSyxFQUFRcEIsU0FBV04sRUFBY3NHLFdBRTFDdkcsS0FBSytGLGlCQUFtQlcsRUFDeEIxRyxLQUFLNEcsZ0JBQWdCLEdBRXpCLENBRUExQixnQkFDRSxNQUFNMkIsRUFBUyxHQUFHN0csS0FBSzhGLG9CQUN2QjlGLEtBQUtzRCxRQUFRUSxjQUFjLE1BQU90RCxHQUFLcUcsRUFDdkM3RyxLQUFLc0QsUUFBUVEsY0FBYyxNQUFPOEIsWUFBYzVGLEtBQUs4RixLQUFLZ0IsY0FBVjlHLFdBQ2xELENBRVE0RyxpQkFDUzNELFNBQVNDLGVBQWUsR0FBR2xELEtBQUs4RixxQkFDeENpQixVQUFZLEdBQ25CLElBQUssTUFBTUMsS0FBV2hILEtBQUsrRixpQkFDekIsSUFBSVosRUFBWW5GLEtBQUtzRCxRQUFRUSxjQUFjLE1BQU90RCxHQUFJd0csRUFFMUQsRUFqREEsR0FEQ3hILEcsb0NBV0QsR0FEQ0EsRyxnQ0FPRCxHQURDQSxHLHFDQ25DSCxJQUFJbUUsRUFDSixJQUFJa0MsRUFBWSxVQUNoQixJQUFJQSxFQUFZLFciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvZGVjb3JhdG9ycy9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL3N0YXRlL3Byb2plY3Qtc3RhdGUudHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL3V0aWwvdmFsaWRhdGlvbi50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL2RyYWctZHJvcC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly9kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vZHJhZy1kcm9wLy4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvL2F1dG9iaW5kIGRlY29yYXRvclxuZXhwb3J0IGZ1bmN0aW9uIGF1dG9CaW5kKF90YXJnZXQ6IGFueSwgX21ldGhvZE5hbWU6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKTogUHJvcGVydHlEZXNjcmlwdG9yIHtcbiAgY29uc3QgbmV3RGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBnZXQoKSB7XG4gICAgICByZXR1cm4gZGVzY3JpcHRvci52YWx1ZS5iaW5kKHRoaXMpXG4gICAgfVxuICB9XG4gIHJldHVybiBuZXdEZXNjcmlwdG9yXG59XG4iLCIvL1Byb2plYyBUeXBlXG5leHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHsgQWN0aXZlLCBGaW5pc2hlZCB9XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcbiAgaWQ6IHN0cmluZ1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcbiAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcbiAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xuICApIHtcbiAgICB0aGlzLmlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygpXG4gIH1cbn1cbiIsIi8vUHJvamVjdCBTdGF0ZSBNYW5hZ2VtZW50XG5cbmltcG9ydCB7IFByb2plY3QsIFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcblxuLy9MaXN0ZW5lciBUeXBlXG50eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWRcblxuY2xhc3MgU3RhdGU8VD4ge1xuICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XG5cbiAgYWRkTGlzdGVuZXIobGlzdGVuZXI6IExpc3RlbmVyPFQ+KSB7XG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lcilcbiAgfVxufVxuXG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PntcbiAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RhdGU7XG5cbiAgc3RhdGljIGdldEluc3RhbmNlKCkge1xuICAgIGlmICghdGhpcy5pbnN0YW5jZSkge1xuICAgICAgdGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGUoKVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZVxuICB9XG5cbiAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBwZW9wbGU6IG51bWJlcikge1xuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcbiAgICAgIHRpdGxlLFxuICAgICAgZGVzY3JpcHRpb24sXG4gICAgICBwZW9wbGUsXG4gICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxuICAgIClcblxuICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcbiAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xuICB9XG5cbiAgbW92ZVByb2plY3QocHJvamVjdElkOiBzdHJpbmcsIG5ld1N0YXR1czogUHJvamVjdFN0YXR1cykge1xuICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQocHJqID0+IHByai5pZCA9PT0gcHJvamVjdElkKTtcblxuICAgIGlmKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cykge1xuICAgICAgcHJvamVjdC5zdGF0dXMgPSBuZXdTdGF0dXM7XG4gICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xuICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdGhpcy5saXN0ZW5lcnMpIHtcbiAgICAgIGxpc3RlbmVyKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKSIsIi8vVmFsaWRhdGlvbiBsb2dpY1xuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XG4gIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIsXG4gIHJlcXVpcmVkPzogYm9vbGVhbixcbiAgbWluTGVuZ3RoPzogbnVtYmVyLFxuICBtYXhMZW5ndGg/OiBudW1iZXIsXG4gIG1pbj86IG51bWJlcixcbiAgbWF4PzogbnVtYmVyLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGFibGVJbnB1dDogVmFsaWRhdGFibGUpIHtcbiAgbGV0IGlzVmFsaWQgPSB0cnVlO1xuICBpZiAodmFsaWRhdGFibGVJbnB1dC5yZXF1aXJlZCkge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoICE9PSAwXG4gIH1cblxuICBpZiAodmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPj0gdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGhcbiAgfVxuXG4gIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aFxuICB9XG5cbiAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA+PSB2YWxpZGF0YWJsZUlucHV0Lm1pblxuICB9XG5cbiAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heFxuICB9XG4gIHJldHVybiBpc1ZhbGlkXG59IiwiLy8gQ29tcG9uZW50IEJhc2UgQ2xhc3NcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcbiAgdGVtcGxhdGVFbGVtZW50OiBIVE1MVGVtcGxhdGVFbGVtZW50O1xuICBob3N0RWxlbWVudDogVDtcbiAgZWxlbWVudDogVTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICB0ZW1wbGF0ZUlkOiBzdHJpbmcsXG4gICAgaG9zdEVsZW1lbnQ6IHN0cmluZyxcbiAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLFxuICAgIG5ld0VsZW1lbnRJZD86IHN0cmluZyxcblxuICApIHtcbiAgICB0aGlzLnRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBsYXRlSWQpIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50KSBhcyBUO1xuXG4gICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZShcbiAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsXG4gICAgICB0cnVlXG4gICAgKTtcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcblxuICAgIGlmIChuZXdFbGVtZW50SWQpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZDtcbiAgICB9XG5cbiAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KTtcbiAgfVxuXG4gIHByaXZhdGUgYXR0YWNoKGluc2VydEF0QmVnaW5uaW5nOiBib29sZWFuKSB7XG4gICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoaW5zZXJ0QXRCZWdpbm5pbmcgPyAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50KTtcbiAgfVxuXG4gIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xuICBhYnN0cmFjdCByZW5kZXJDb250ZW50KCk6IHZvaWQ7XG59IiwiaW1wb3J0IHsgYXV0b0JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcbmltcG9ydCB7IFZhbGlkYXRhYmxlLCB2YWxpZGF0ZSB9IGZyb20gXCIuLi91dGlsL3ZhbGlkYXRpb25cIjtcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XG5cbi8vIFByb2plY3QgSW5wdXQgQ2xhc3NcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SW5wdXQgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxGb3JtRWxlbWVudD57XG4gIHRpdGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuICBkZXNjcmlwdGlvbklucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgcGVvcGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCdwcm9qZWN0LWlucHV0JywgJ2FwcCcsIHRydWUsICd1c2VyLWlucHV0JylcblxuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3RpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkZXNjcmlwdGlvbicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3Blb3BsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICB9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIpXG4gIH07XG5cbiAgcHJpdmF0ZSBjbGVhbklucHV0cygpOiB2b2lkIHtcbiAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gIH1cblxuICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcbiAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgIGNvbnN0IGVudGVyZWREZXNjcmlwdGlvbiA9IHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWU7XG4gICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuXG4gICAgY29uc3QgdGl0bGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XG4gICAgICB2YWx1ZTogZW50ZXJlZFRpdGxlLFxuICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICB9XG5cbiAgICBjb25zdCBkZXNjY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XG4gICAgICB2YWx1ZTogZW50ZXJlZERlc2NyaXB0aW9uLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBtaW5MZW5ndGg6IDVcbiAgICB9XG5cbiAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XG4gICAgICB2YWx1ZTogK2VudGVyZWRQZW9wbGUsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIG1pbjogMSxcbiAgICAgIG1heDogMTBcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICB2YWxpZGF0ZSh0aXRsZVZhbGlkYXRhYmxlKSAmJlxuICAgICAgdmFsaWRhdGUoZGVzY2NyaXB0aW9uVmFsaWRhdGFibGUpICYmXG4gICAgICB2YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSlcbiAgICApIHtcbiAgICAgIHJldHVybiBbZW50ZXJlZFRpdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUGVvcGxlXTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoJ0ludmFsaWQgaW5wdXQsIHBsZWFzZSB0cnkgYWdhaW4hJyk7XG4gICAgfVxuXG4gIH1cblxuICBAYXV0b0JpbmRcbiAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OiBTdWJtaXRFdmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xuICAgICAgY29uc3QgW3RpdGxlLCBkZXNjLCBwZW9wbGVdID0gdXNlcklucHV0O1xuICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QodGl0bGUsIGRlc2MsIHBlb3BsZSk7XG4gICAgICB0aGlzLmNsZWFuSW5wdXRzKClcbiAgICB9XG4gIH1cblxuICByZW5kZXJDb250ZW50KCk6IHZvaWQge1xuICB9XG59IiwiLy9Qcm9qZWN0SXRlbSBDbGFzc1xuXG5pbXBvcnQgeyBhdXRvQmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XG5pbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcFwiO1xuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcblxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ2dhYmxlIHtcbiAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0XG5cbiAgZ2V0IHBlcnNvbnMoKSB7XG4gICAgaWYgKHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEpIHtcbiAgICAgIHJldHVybiAnMSBwZXJzb24nXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYFxuICAgIH1cbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XG4gICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0JywgaG9zdElkLCB0cnVlLCBwcm9qZWN0LmlkKTtcblxuICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICB9XG5cbiAgQGF1dG9CaW5kXG4gIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgIGV2ZW50LmRhdGFUcmFuc2Zlcj8uc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZCk7XG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnXG4gIH1cblxuICBkcmFnRW5kSGFuZGxlcihfOiBEcmFnRXZlbnQpIHtcbiAgICBcbiAgfVxuXG4gIGNvbmZpZ3VyZSgpOiB2b2lkIHtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKVxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcilcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LnRpdGxlO1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucyArICcgJyArICdhc3NpZ25lZCc7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XG4gIH1cbn0iLCIvL1Byb2plY3RMaXN0IENsYXNzXG5cbmltcG9ydCB7IGF1dG9CaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcbmltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcFwiO1xuaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiO1xuXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xuXG4gIGFzc2lnbmVkUHJvamVjdHM6IFByb2plY3RbXTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6ICdhY3RpdmUnIHwgJ2ZpbmlzaGVkJykge1xuICAgIHN1cGVyKCdwcm9qZWN0LWxpc3QnLCAnYXBwJywgZmFsc2UsIGAke3R5cGV9LXByb2plY3RzYCk7XG5cbiAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSBbXTtcblxuICAgIHRoaXMuY29uZmlndXJlKCk7XG4gICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XG4gIH1cblxuICBAYXV0b0JpbmRcbiAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcbiAgICBpZihldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XG4gICAgICBsaXN0RWwuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJylcbiAgICB9XG5cbiAgfVxuXG4gIEBhdXRvQmluZFxuICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgcHJqSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcbiAgICBwcm9qZWN0U3RhdGUubW92ZVByb2plY3QocHJqSWQsIHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScgPyBQcm9qZWN0U3RhdHVzLkFjdGl2ZSA6IFByb2plY3RTdGF0dXMuRmluaXNoZWQpO1xuICB9XG5cbiAgQGF1dG9CaW5kXG4gIGRyYWdMZWF2ZUhhbmRsZXIoXzogRHJhZ0V2ZW50KTogdm9pZCB7XG4gICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xuICAgIGxpc3RFbC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKVxuICB9XG5cbiAgY29uZmlndXJlKCk6IHZvaWQge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xuICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xuICAgICAgY29uc3QgcmVsZXZhbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcihwcm9qZWN0ID0+IHtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgICByZXR1cm4gcHJvamVjdC5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuQWN0aXZlXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2plY3Quc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkXG4gICAgICB9KVxuICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcmVsZXZhbnRQcm9qZWN0cztcbiAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKTtcbiAgICB9KTtcbiAgfTtcblxuICByZW5kZXJDb250ZW50KCkge1xuICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdC1saXN0YDtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWQ7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy50eXBlLnRvVXBwZXJDYXNlKCkgKyAnICcgKyAnUFJPSkVDVFMnXG4gIH1cblxuICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xuICAgIGNvbnN0IGxpc3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3RoaXMudHlwZX0tcHJvamVjdC1saXN0YCkgYXMgSFRNTEVsZW1lbnQ7XG4gICAgbGlzdEVsLmlubmVySFRNTCA9ICcnXG4gICAgZm9yIChjb25zdCBwcmpJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xuICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCwgcHJqSXRlbSk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXRcIjtcbmltcG9ydCB7IFByb2plY3RMaXN0IH0gZnJvbSBcIi4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3RcIjtcblxubmV3IFByb2plY3RJbnB1dCgpO1xubmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKTtcbm5ldyBQcm9qZWN0TGlzdCgnZmluaXNoZWQnKTsiXSwibmFtZXMiOlsiYXV0b0JpbmQiLCJfdGFyZ2V0IiwiX21ldGhvZE5hbWUiLCJkZXNjcmlwdG9yIiwiY29uZmlndXJhYmxlIiwiZ2V0IiwidmFsdWUiLCJiaW5kIiwidGhpcyIsIlByb2plY3RTdGF0dXMiLCJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiaWQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJQcm9qZWN0U3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyIiwicHVzaCIsInByb2plY3RzIiwic3RhdGljIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwibmV3UHJvamVjdCIsIkFjdGl2ZSIsInVwZGF0ZUxpc3RlbmVycyIsIm1vdmVQcm9qZWN0IiwicHJvamVjdElkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwcmoiLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwidmFsaWRhdGUiLCJ2YWxpZGF0YWJsZUlucHV0IiwiaXNWYWxpZCIsInJlcXVpcmVkIiwidHJpbSIsImxlbmd0aCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsIkNvbXBvbmVudCIsInRlbXBsYXRlSWQiLCJob3N0RWxlbWVudCIsImluc2VydEF0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhdHRhY2giLCJpbnNlcnRBdEJlZ2lubmluZyIsImluc2VydEFkamFjZW50RWxlbWVudCIsIlByb2plY3RJbnB1dCIsInN1cGVyIiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJhZGRFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsImNsZWFuSW5wdXRzIiwiZ2F0aGVyVXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NjcmlwdGlvblZhbGlkYXRhYmxlIiwicGVvcGxlVmFsaWRhdGFibGUiLCJhbGVydCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJkZXNjIiwicmVuZGVyQ29udGVudCIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwicGVyc29ucyIsImRyYWdTdGFydEhhbmRsZXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwiXyIsInRleHRDb250ZW50IiwiUHJvamVjdExpc3QiLCJ0eXBlIiwiYXNzaWduZWRQcm9qZWN0cyIsImRyYWdPdmVySGFuZGxlciIsInR5cGVzIiwiY2xhc3NMaXN0IiwiYWRkIiwiZHJvcEhhbmRsZXIiLCJwcmpJZCIsImdldERhdGEiLCJGaW5pc2hlZCIsImRyYWdMZWF2ZUhhbmRsZXIiLCJyZW1vdmUiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByakl0ZW0iXSwic291cmNlUm9vdCI6IiJ9